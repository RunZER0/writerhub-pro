<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Submit Assignment - HomeworkPal</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/svg+xml" href="/icons/icon.svg">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Space Grotesk', sans-serif;
            background: #0a0a0f;
            color: #fff;
            min-height: 100vh;
        }

        .bg-mesh {
            position: fixed;
            inset: 0;
            z-index: 0;
            background: 
                radial-gradient(ellipse 80% 50% at 20% 40%, rgba(120, 0, 255, 0.1), transparent),
                radial-gradient(ellipse 60% 40% at 80% 20%, rgba(0, 200, 255, 0.08), transparent),
                #0a0a0f;
            pointer-events: none;
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            padding: 1rem 3rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(10, 10, 15, 0.9);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.6rem;
            font-size: 1.3rem;
            font-weight: 700;
            color: #fff;
            text-decoration: none;
        }

        .logo i {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-links {
            display: flex;
            gap: 1rem;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.6rem 1.2rem;
            border-radius: 8px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s;
            font-size: 0.9rem;
            border: none;
            cursor: pointer;
        }

        .btn-ghost {
            background: transparent;
            color: rgba(255,255,255,0.7);
        }

        .btn-ghost:hover {
            color: #fff;
        }

        .btn-primary {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: #fff;
        }

        .btn-primary:hover {
            box-shadow: 0 0 30px rgba(99, 102, 241, 0.4);
        }

        /* Main Container */
        .main {
            position: relative;
            z-index: 1;
            padding: 6rem 5% 4rem;
        }

        /* Page Header */
        .page-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .page-header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .page-header p {
            color: rgba(255,255,255,0.5);
        }

        /* Tabs */
        .tabs {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 3rem;
        }

        .tab {
            padding: 0.75rem 1.5rem;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 10px;
            color: rgba(255,255,255,0.6);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab:hover {
            background: rgba(255,255,255,0.06);
            color: #fff;
        }

        .tab.active {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            border-color: transparent;
            color: #fff;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Pricing Section */
        .pricing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            max-width: 1100px;
            margin: 0 auto;
        }

        .pricing-card {
            background: rgba(255,255,255,0.02);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 20px;
            padding: 2rem;
            position: relative;
            overflow: hidden;
            transition: all 0.4s;
        }

        .pricing-card:hover {
            transform: translateY(-5px);
            border-color: rgba(255,255,255,0.15);
        }

        .pricing-card.popular {
            border-color: rgba(99, 102, 241, 0.5);
            background: rgba(99, 102, 241, 0.05);
        }

        .pricing-card.popular::before {
            content: 'MOST POPULAR';
            position: absolute;
            top: 1rem;
            right: -2rem;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: #fff;
            font-size: 0.65rem;
            font-weight: 700;
            padding: 0.3rem 2.5rem;
            transform: rotate(45deg);
        }

        .pricing-tier {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .tier-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .pricing-card:nth-child(1) .tier-icon {
            background: linear-gradient(135deg, #cd7f32, #8b4513);
        }

        .pricing-card:nth-child(2) .tier-icon {
            background: linear-gradient(135deg, #c0c0c0, #808080);
        }

        .pricing-card:nth-child(3) .tier-icon {
            background: linear-gradient(135deg, #ffd700, #b8860b);
        }

        .tier-name {
            font-size: 1.25rem;
            font-weight: 700;
        }

        .pricing-price {
            margin-bottom: 1.5rem;
        }

        .price-range {
            font-size: 2rem;
            font-weight: 700;
        }

        .price-range sup {
            font-size: 0.5em;
            vertical-align: super;
            font-weight: 600;
        }

        .price-unit {
            color: rgba(255,255,255,0.5);
            font-size: 0.9rem;
        }

        .pricing-features {
            list-style: none;
            margin-bottom: 2rem;
        }

        .pricing-features li {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.6rem 0;
            color: rgba(255,255,255,0.7);
            font-size: 0.9rem;
        }

        .pricing-features li i {
            color: #10b981;
            width: 20px;
        }

        .pricing-card .btn {
            width: 100%;
            justify-content: center;
            padding: 0.9rem;
        }

        .pricing-card:nth-child(1) .btn-select {
            background: linear-gradient(135deg, #cd7f32, #8b4513);
        }

        .pricing-card:nth-child(2) .btn-select {
            background: linear-gradient(135deg, #c0c0c0, #808080);
        }

        .pricing-card:nth-child(3) .btn-select {
            background: linear-gradient(135deg, #ffd700, #b8860b);
            color: #000;
        }

        /* Form Section */
        .form-container {
            max-width: 700px;
            margin: 0 auto;
        }

        .form-card {
            background: rgba(255,255,255,0.02);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 20px;
            padding: 2rem;
        }

        .selected-package {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 12px;
            margin-bottom: 2rem;
        }

        .selected-package .package-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .selected-package .package-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .selected-package .change-btn {
            color: #6366f1;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .form-group label .required {
            color: #ef4444;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            background: rgba(255,255,255,0.03);
            color: #fff;
            font-size: 0.95rem;
            font-family: inherit;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 120px;
        }

        .form-group select option {
            background: #1a1a2e;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        @media (max-width: 600px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        /* Domain Selection */
        .domain-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 0.75rem;
        }

        .domain-option {
            padding: 1rem 0.5rem;
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(255,255,255,0.02);
        }

        .domain-option:hover {
            border-color: rgba(99, 102, 241, 0.5);
        }

        .domain-option.selected {
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.1);
        }

        .domain-option i {
            display: block;
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
            color: #6366f1;
        }

        .domain-option span {
            font-size: 0.8rem;
            font-weight: 500;
        }

        /* Deadline Options */
        .deadline-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 0.75rem;
        }

        .deadline-option {
            padding: 1rem;
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(255,255,255,0.02);
        }

        .deadline-option:hover {
            border-color: rgba(99, 102, 241, 0.5);
        }

        .deadline-option.selected {
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.1);
        }

        .deadline-option .time {
            font-size: 1.1rem;
            font-weight: 700;
        }

        .deadline-option .label {
            font-size: 0.7rem;
            color: rgba(255,255,255,0.5);
            margin-top: 0.25rem;
        }

        /* File Upload */
        .file-upload {
            border: 2px dashed rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .file-upload:hover {
            border-color: #6366f1;
            background: rgba(99, 102, 241, 0.05);
        }

        .file-upload i {
            font-size: 2rem;
            color: #6366f1;
            margin-bottom: 0.75rem;
        }

        .file-upload p {
            color: rgba(255,255,255,0.5);
            font-size: 0.85rem;
        }

        .file-upload input {
            display: none;
        }

        .uploaded-files {
            margin-top: 1rem;
        }

        .uploaded-file {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
            margin-bottom: 0.5rem;
        }

        .uploaded-file i { color: #6366f1; }
        .uploaded-file span { flex: 1; font-size: 0.85rem; }
        .uploaded-file .remove {
            color: #ef4444;
            cursor: pointer;
        }

        /* Price Estimate */
        .price-estimate {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 12px;
            padding: 1.25rem;
            margin-bottom: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .price-estimate .label {
            font-size: 0.9rem;
            color: rgba(255,255,255,0.7);
        }

        .price-estimate .amount {
            font-size: 1.5rem;
            font-weight: 700;
            color: #10b981;
        }

        /* Form Submit */
        .form-submit {
            display: flex;
            gap: 1rem;
        }

        .form-submit .btn {
            flex: 1;
            justify-content: center;
            padding: 1rem;
        }

        /* Success Page */
        .success-container {
            text-align: center;
            padding: 4rem 2rem;
            max-width: 500px;
            margin: 0 auto;
        }

        .success-icon {
            width: 80px;
            height: 80px;
            background: #10b981;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 2rem;
            animation: scaleIn 0.5s ease;
        }

        @keyframes scaleIn {
            from { transform: scale(0); }
            to { transform: scale(1); }
        }

        .success-container h2 {
            font-size: 1.75rem;
            margin-bottom: 0.5rem;
        }

        .success-container p {
            color: rgba(255,255,255,0.5);
            margin-bottom: 2rem;
        }

        .order-id {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 10px;
            font-family: monospace;
            font-size: 1.1rem;
            letter-spacing: 1px;
            margin-bottom: 2rem;
        }

        /* Toast */
        .toast-container {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 10000;
        }

        .toast {
            padding: 1rem 1.5rem;
            background: rgba(30, 30, 50, 0.95);
            border-radius: 10px;
            border-left: 4px solid #10b981;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            margin-top: 0.5rem;
            animation: slideIn 0.3s ease;
        }

        .toast.error { border-left-color: #ef4444; }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Loading */
        .loading {
            display: none;
            text-align: center;
            padding: 3rem;
        }

        .loading.active { display: block; }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255,255,255,0.1);
            border-top-color: #6366f1;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Hidden */
        .hidden { display: none !important; }

        /* Referral Banner */
        .referral-banner {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(99, 102, 241, 0.15));
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 12px;
            padding: 1rem 1.5rem;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .referral-banner i {
            font-size: 1.5rem;
            color: #10b981;
        }

        .referral-banner .ref-content {
            flex: 1;
        }

        .referral-banner .ref-title {
            font-weight: 600;
            color: #10b981;
        }

        .referral-banner .ref-text {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.7);
        }

        .referral-banner .ref-discount {
            background: #10b981;
            color: #000;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.85rem;
        }

        /* Referral Success Box */
        .referral-success-box {
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            text-align: center;
        }

        .referral-success-box h4 {
            color: #6366f1;
            margin-bottom: 0.5rem;
        }

        .referral-code-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin: 1rem 0;
        }

        .referral-code-display input {
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(99, 102, 241, 0.5);
            border-radius: 8px;
            padding: 0.75rem 1rem;
            color: #fff;
            font-family: monospace;
            font-size: 1rem;
            text-align: center;
            width: 280px;
        }

        .referral-code-display .copy-btn {
            background: #6366f1;
            border: none;
            border-radius: 8px;
            padding: 0.75rem 1rem;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s;
        }

        .referral-code-display .copy-btn:hover {
            background: #4f46e5;
        }

        .referral-share-btns {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            margin-top: 1rem;
        }

        .referral-share-btns button {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s;
        }

        .share-whatsapp {
            background: #25d366;
            color: #fff;
        }

        .share-copy {
            background: rgba(255,255,255,0.1);
            color: #fff;
            border: 1px solid rgba(255,255,255,0.2) !important;
        }

        /* Membership Styles - Blended Design */
        .membership-section {
            max-width: 1100px;
            margin: 0 auto;
            position: relative;
        }

        /* Floating Tier Indicators */
        .tier-indicators {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-bottom: 3rem;
            flex-wrap: wrap;
        }

        .tier-pill {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 50px;
            font-size: 0.85rem;
            color: rgba(255,255,255,0.7);
            transition: all 0.3s;
        }

        .tier-pill:hover {
            background: rgba(99, 102, 241, 0.1);
            border-color: rgba(99, 102, 241, 0.3);
        }

        .tier-pill .tier-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

        .tier-pill.basic .tier-dot { background: linear-gradient(135deg, #10b981, #059669); }
        .tier-pill.silver .tier-dot { background: linear-gradient(135deg, #c0c0c0, #808080); }
        .tier-pill.gold .tier-dot { background: linear-gradient(135deg, #ffd700, #b8860b); }
        .tier-pill.platinum .tier-dot { background: linear-gradient(135deg, #e5e4e2, #8b8b8b); }

        /* Auth Container - Seamless Design */
        .membership-auth-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            align-items: start;
            position: relative;
        }

        @media (max-width: 900px) {
            .membership-auth-container {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
        }

        /* Benefits Side */
        .membership-benefits-side {
            padding: 2rem 0;
        }

        .membership-benefits-side h2 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, #fff, rgba(255,255,255,0.7));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .membership-benefits-side .subtitle {
            color: rgba(255,255,255,0.5);
            font-size: 1rem;
            margin-bottom: 2rem;
        }

        .benefit-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .benefit-row {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255,255,255,0.02);
            border-radius: 12px;
            transition: all 0.3s;
        }

        .benefit-row:hover {
            background: rgba(99, 102, 241, 0.05);
        }

        .benefit-row .icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            flex-shrink: 0;
        }

        .benefit-row:nth-child(1) .icon { background: rgba(99, 102, 241, 0.15); color: #818cf8; }
        .benefit-row:nth-child(2) .icon { background: rgba(16, 185, 129, 0.15); color: #34d399; }
        .benefit-row:nth-child(3) .icon { background: rgba(245, 158, 11, 0.15); color: #fbbf24; }
        .benefit-row:nth-child(4) .icon { background: rgba(236, 72, 153, 0.15); color: #f472b6; }

        .benefit-row .content h4 {
            font-size: 0.95rem;
            margin-bottom: 0.25rem;
        }

        .benefit-row .content p {
            font-size: 0.8rem;
            color: rgba(255,255,255,0.5);
            line-height: 1.4;
        }

        /* Auth Forms Side */
        .membership-auth-side {
            position: relative;
        }

        .auth-mode-toggle {
            display: flex;
            margin-bottom: 1.5rem;
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            padding: 0.25rem;
        }

        .auth-mode-btn {
            flex: 1;
            padding: 0.75rem 1rem;
            background: transparent;
            border: none;
            color: rgba(255,255,255,0.5);
            font-weight: 500;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .auth-mode-btn.active {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: #fff;
        }

        .auth-mode-btn:hover:not(.active) {
            color: #fff;
        }

        /* Seamless Form Fields */
        .seamless-form {
            display: none;
        }

        .seamless-form.active {
            display: block;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .seamless-input-group {
            margin-bottom: 1rem;
        }

        .seamless-input-group label {
            display: block;
            font-size: 0.8rem;
            color: rgba(255,255,255,0.6);
            margin-bottom: 0.5rem;
        }

        .seamless-input {
            width: 100%;
            padding: 0.875rem 1rem;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 10px;
            color: #fff;
            font-size: 0.95rem;
            transition: all 0.3s;
        }

        .seamless-input:focus {
            outline: none;
            border-color: rgba(99, 102, 241, 0.5);
            background: rgba(99, 102, 241, 0.05);
        }

        .seamless-input::placeholder {
            color: rgba(255,255,255,0.3);
        }

        .input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        @media (max-width: 500px) {
            .input-row {
                grid-template-columns: 1fr;
            }
        }

        .auth-submit-btn {
            width: 100%;
            padding: 1rem;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            border: none;
            border-radius: 10px;
            color: #fff;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 0.5rem;
        }

        .auth-submit-btn:hover {
            box-shadow: 0 10px 40px rgba(99, 102, 241, 0.3);
            transform: translateY(-2px);
        }

        /* Member Portal - Full Page Dashboard */
        .member-portal {
            display: none;
        }

        .member-portal.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        .portal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid rgba(255,255,255,0.08);
        }

        .portal-user {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .portal-avatar {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            font-weight: 700;
        }

        .portal-user-info h3 {
            font-size: 1.1rem;
            margin-bottom: 0.25rem;
        }

        .tier-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            padding: 0.3rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .tier-badge.basic { background: rgba(16, 185, 129, 0.15); color: #34d399; }
        .tier-badge.silver { background: rgba(192, 192, 192, 0.2); color: #e0e0e0; }
        .tier-badge.gold { background: rgba(255, 215, 0, 0.15); color: #ffd700; }
        .tier-badge.platinum { background: rgba(229, 228, 226, 0.15); color: #e5e4e2; }

        .portal-logout-btn {
            padding: 0.6rem 1.2rem;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            color: rgba(255,255,255,0.7);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .portal-logout-btn:hover {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.3);
            color: #f87171;
        }

        /* Stats Grid */
        .portal-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }

        @media (max-width: 768px) {
            .portal-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .stat-card {
            background: rgba(255,255,255,0.02);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 12px;
            padding: 1.25rem;
            text-align: center;
            transition: all 0.3s;
        }

        .stat-card:hover {
            border-color: rgba(99, 102, 241, 0.3);
        }

        .stat-card .stat-value {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .stat-card:nth-child(1) .stat-value { color: #6366f1; }
        .stat-card:nth-child(2) .stat-value { color: #10b981; }
        .stat-card:nth-child(3) .stat-value { color: #f59e0b; }
        .stat-card:nth-child(4) .stat-value { color: #ec4899; }

        .stat-card .stat-label {
            font-size: 0.8rem;
            color: rgba(255,255,255,0.5);
        }

        /* Portal Grid */
        .portal-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 1.5rem;
        }

        @media (max-width: 900px) {
            .portal-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Progress Section */
        .progress-section {
            background: rgba(255,255,255,0.02);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 16px;
            padding: 1.5rem;
        }

        .progress-section h4 {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.25rem;
            font-size: 1rem;
        }

        .progress-section h4 i {
            color: #6366f1;
        }

        .tier-progress {
            margin-bottom: 1.5rem;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .progress-header .current {
            font-weight: 600;
        }

        .progress-header .next {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.5);
        }

        .progress-bar {
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #6366f1, #8b5cf6);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .progress-details {
            display: flex;
            justify-content: space-between;
            margin-top: 0.75rem;
            font-size: 0.8rem;
            color: rgba(255,255,255,0.5);
        }

        /* Quick Actions */
        .quick-actions-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .quick-action-btn {
            padding: 1rem;
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 12px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .quick-action-btn:hover {
            background: rgba(99, 102, 241, 0.2);
            transform: translateY(-2px);
        }

        .quick-action-btn i {
            display: block;
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
            color: #818cf8;
        }

        .quick-action-btn span {
            font-size: 0.85rem;
            font-weight: 500;
        }

        /* Referral Section in Portal */
        .referral-section {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(6, 182, 212, 0.1));
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 16px;
            padding: 1.5rem;
        }

        .referral-section h4 {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            font-size: 1rem;
            color: #10b981;
        }

        .referral-section p {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.6);
            margin-bottom: 1rem;
        }

        .referral-code-box {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .referral-code-input {
            flex: 1;
            padding: 0.75rem;
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 8px;
            color: #fff;
            font-family: monospace;
            font-size: 0.9rem;
            text-align: center;
        }

        .referral-copy-btn {
            padding: 0.75rem 1rem;
            background: #10b981;
            border: none;
            border-radius: 8px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s;
        }

        .referral-copy-btn:hover {
            background: #059669;
        }

        .referral-share-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .share-btn {
            flex: 1;
            padding: 0.6rem;
            border: none;
            border-radius: 8px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .share-btn.whatsapp {
            background: #25d366;
            color: #fff;
        }

        .share-btn.copy-link {
            background: rgba(255,255,255,0.1);
            color: #fff;
            border: 1px solid rgba(255,255,255,0.2);
        }

        /* Perks List */
        .portal-perks {
            margin-top: 1.5rem;
            padding: 1rem;
            background: rgba(255,255,255,0.02);
            border-radius: 12px;
        }

        .portal-perks h5 {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.7);
            margin-bottom: 0.75rem;
        }

        .perk-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.4rem 0;
            font-size: 0.85rem;
            color: rgba(255,255,255,0.7);
        }

        .perk-item i {
            color: #10b981;
            font-size: 0.8rem;
        }

        /* Price Calculation Display */
        .price-calc-display {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            display: none;
        }

        .price-calc-display.visible {
            display: block;
        }

        .price-calc-row {
            display: flex;
            justify-content: space-between;
            padding: 0.4rem 0;
            font-size: 0.9rem;
        }

        .price-calc-row.total {
            border-top: 1px solid rgba(255,255,255,0.1);
            margin-top: 0.5rem;
            padding-top: 0.75rem;
            font-weight: 600;
        }

        .price-calc-row .discount {
            color: #10b981;
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
        }

        .member-dashboard {
            display: none;
        }

        .member-dashboard.active {
            display: block;
        }

        .member-card {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .member-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .member-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .member-info h3 {
            margin-bottom: 0.25rem;
        }

        .member-tier-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            background: linear-gradient(135deg, #10b981, #059669);
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .member-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }

        .stat-box {
            text-align: center;
            padding: 0.75rem;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
        }

        .stat-box .value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #6366f1;
        }

        .stat-box .label {
            font-size: 0.75rem;
            color: rgba(255,255,255,0.5);
        }

        .perks-list {
            list-style: none;
        }

        .perks-list li {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 0;
            color: rgba(255,255,255,0.8);
        }

        .perks-list li i {
            color: #10b981;
        }

        /* Mobile */
        @media (max-width: 768px) {
            nav {
                padding: 1rem 1.5rem;
            }

            .main {
                padding: 5rem 1rem 2rem;
            }

            .page-header h1 {
                font-size: 1.75rem;
            }

            .tabs {
                flex-wrap: wrap;
            }

            .pricing-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="bg-mesh"></div>

    <nav>
        <a href="/" class="logo">
            <i class="fas fa-graduation-cap"></i>
            HomeworkPal
        </a>
        <div class="nav-links">
            <a href="/" class="btn btn-ghost"><i class="fas fa-home"></i> Home</a>
        </div>
    </nav>

    <main class="main">
        <!-- Referral Banner (shown when arriving via referral link) -->
        <div class="referral-banner hidden" id="referralBanner">
            <i class="fas fa-gift"></i>
            <div class="ref-content">
                <div class="ref-title">ðŸŽ‰ You were referred by <span id="referrerName">a friend</span>!</div>
                <div class="ref-text">Complete your first order to unlock your welcome bonus</div>
            </div>
            <div class="ref-discount">10% OFF</div>
        </div>

        <div class="page-header">
            <h1>Get Your Assignment Done</h1>
            <p>Choose a package and submit your requirements</p>
        </div>

        <div class="tabs">
            <div class="tab active" data-tab="pricing">
                <i class="fas fa-tags"></i> Pricing
            </div>
            <div class="tab" data-tab="submit">
                <i class="fas fa-paper-plane"></i> Submit Assignment
            </div>
            <div class="tab" data-tab="membership">
                <i class="fas fa-crown"></i> Membership
            </div>
            <div class="tab" data-tab="inquiry">
                <i class="fas fa-question-circle"></i> Inquiry
            </div>
        </div>

        <!-- Pricing Tab -->
        <div class="tab-content active" id="pricing-tab">
            <div class="pricing-grid">
                <!-- Bronze -->
                <div class="pricing-card" data-package="bronze">
                    <div class="pricing-tier">
                        <div class="tier-icon"><i class="fas fa-medal"></i></div>
                        <div class="tier-name">Bronze</div>
                    </div>
                    <div class="pricing-price">
                        <span class="price-range">$6<sup>.99</sup> - $9<sup>.99</sup></span>
                        <span class="price-unit">/ page</span>
                    </div>
                    <ul class="pricing-features">
                        <li><i class="fas fa-check"></i> Standard delivery (5-7 days)</li>
                        <li><i class="fas fa-check"></i> Plagiarism-free content</li>
                        <li><i class="fas fa-check"></i> Basic formatting</li>
                        <li><i class="fas fa-check"></i> 1 free revision</li>
                        <li><i class="fas fa-check"></i> Email support</li>
                    </ul>
                    <button class="btn btn-select" onclick="selectPackage('bronze', 6.99, 9.99)">
                        Select Bronze
                    </button>
                </div>

                <!-- Silver -->
                <div class="pricing-card popular" data-package="silver">
                    <div class="pricing-tier">
                        <div class="tier-icon"><i class="fas fa-medal"></i></div>
                        <div class="tier-name">Silver</div>
                    </div>
                    <div class="pricing-price">
                        <span class="price-range">$9<sup>.99</sup> - $14<sup>.99</sup></span>
                        <span class="price-unit">/ page</span>
                    </div>
                    <ul class="pricing-features">
                        <li><i class="fas fa-check"></i> Fast delivery (3-5 days)</li>
                        <li><i class="fas fa-check"></i> Plagiarism-free content</li>
                        <li><i class="fas fa-check"></i> Advanced formatting</li>
                        <li><i class="fas fa-check"></i> 3 free revisions</li>
                        <li><i class="fas fa-check"></i> Priority support</li>
                        <li><i class="fas fa-check"></i> Detailed research</li>
                    </ul>
                    <button class="btn btn-select" onclick="selectPackage('silver', 9.99, 14.99)">
                        Select Silver
                    </button>
                </div>

                <!-- Gold -->
                <div class="pricing-card" data-package="gold">
                    <div class="pricing-tier">
                        <div class="tier-icon"><i class="fas fa-crown"></i></div>
                        <div class="tier-name">Gold</div>
                    </div>
                    <div class="pricing-price">
                        <span class="price-range">$15<sup>.99</sup> - $19<sup>.99</sup></span>
                        <span class="price-unit">/ page</span>
                    </div>
                    <ul class="pricing-features">
                        <li><i class="fas fa-check"></i> Express delivery (24-48 hrs)</li>
                        <li><i class="fas fa-check"></i> Plagiarism-free content</li>
                        <li><i class="fas fa-check"></i> Premium formatting</li>
                        <li><i class="fas fa-check"></i> Unlimited revisions</li>
                        <li><i class="fas fa-check"></i> 24/7 VIP support</li>
                        <li><i class="fas fa-check"></i> Expert writer assigned</li>
                        <li><i class="fas fa-check"></i> Plagiarism report included</li>
                    </ul>
                    <button class="btn btn-select" onclick="selectPackage('gold', 15.99, 19.99)">
                        Select Gold
                    </button>
                </div>
            </div>
        </div>

        <!-- Submit Tab -->
        <div class="tab-content" id="submit-tab">
            <div class="form-container">
                <div class="form-card">
                    <div class="selected-package" id="selectedPackage">
                        <div class="package-info">
                            <div class="package-icon" id="packageIcon" style="background: linear-gradient(135deg, #c0c0c0, #808080);">
                                <i class="fas fa-medal"></i>
                            </div>
                            <div>
                                <div id="packageName" style="font-weight: 600;">Silver Package</div>
                                <div id="packagePrice" style="font-size: 0.85rem; color: rgba(255,255,255,0.5);">$10 - $15 per page</div>
                            </div>
                        </div>
                        <button class="change-btn" onclick="showTab('pricing')">Change</button>
                    </div>

                    <form id="assignmentForm">
                        <div class="form-group">
                            <label>Assignment Title <span class="required">*</span></label>
                            <input type="text" id="title" required placeholder="e.g., Research Paper on Climate Change">
                        </div>

                        <div class="form-group">
                            <label>Select Domain <span class="required">*</span></label>
                            <div class="domain-grid" id="domainGrid">
                                <div class="domain-option" data-domain="Maths">
                                    <i class="fas fa-calculator"></i>
                                    <span>Maths</span>
                                </div>
                                <div class="domain-option" data-domain="Chemistry">
                                    <i class="fas fa-flask"></i>
                                    <span>Chemistry</span>
                                </div>
                                <div class="domain-option" data-domain="Physics">
                                    <i class="fas fa-atom"></i>
                                    <span>Physics</span>
                                </div>
                                <div class="domain-option" data-domain="Business">
                                    <i class="fas fa-briefcase"></i>
                                    <span>Business</span>
                                </div>
                                <div class="domain-option" data-domain="Economics">
                                    <i class="fas fa-chart-line"></i>
                                    <span>Economics</span>
                                </div>
                                <div class="domain-option" data-domain="Accounting">
                                    <i class="fas fa-file-invoice-dollar"></i>
                                    <span>Accounting</span>
                                </div>
                                <div class="domain-option" data-domain="English">
                                    <i class="fas fa-book"></i>
                                    <span>English</span>
                                </div>
                                <div class="domain-option" data-domain="History">
                                    <i class="fas fa-landmark"></i>
                                    <span>History</span>
                                </div>
                                <div class="domain-option" data-domain="Law">
                                    <i class="fas fa-gavel"></i>
                                    <span>Law</span>
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Number of Pages <span class="required">*</span></label>
                                <input type="number" id="pages" min="1" value="1" required onchange="calculatePrice()">
                            </div>
                            <div class="form-group">
                                <label>Word Count (approx)</label>
                                <input type="text" id="wordCount" readonly value="~275 words">
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Deadline <span class="required">*</span></label>
                            <div class="deadline-grid" id="deadlineGrid">
                                <div class="deadline-option" data-hours="24">
                                    <div class="time">24h</div>
                                    <div class="label">Express</div>
                                </div>
                                <div class="deadline-option selected" data-hours="72">
                                    <div class="time">3 days</div>
                                    <div class="label">Standard</div>
                                </div>
                                <div class="deadline-option" data-hours="120">
                                    <div class="time">5 days</div>
                                    <div class="label">Relaxed</div>
                                </div>
                                <div class="deadline-option" data-hours="168">
                                    <div class="time">7 days</div>
                                    <div class="label">Extended</div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Description & Instructions <span class="required">*</span></label>
                            <textarea id="description" required placeholder="Provide detailed instructions, requirements, formatting guidelines, etc."></textarea>
                        </div>

                        <div class="form-group">
                            <label>Attach Files (optional)</label>
                            <div class="file-upload" id="fileUpload">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>Click to upload or drag and drop<br><small>PDF, DOC, DOCX, TXT (Max 10MB)</small></p>
                                <input type="file" id="fileInput" multiple accept=".pdf,.doc,.docx,.txt">
                            </div>
                            <div class="uploaded-files" id="uploadedFiles"></div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Your Name <span class="required">*</span></label>
                                <input type="text" id="clientName" required placeholder="John Doe">
                            </div>
                            <div class="form-group">
                                <label>Email Address <span class="required">*</span></label>
                                <input type="email" id="clientEmail" required placeholder="john@example.com">
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Phone Number (optional)</label>
                            <input type="tel" id="clientPhone" placeholder="+1 234 567 8900">
                        </div>

                        <div class="price-estimate">
                            <div class="label">Estimated Price</div>
                            <div class="amount" id="priceEstimate">$10 - $15</div>
                        </div>

                        <div class="form-submit">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-paper-plane"></i> Submit Assignment
                            </button>
                        </div>
                    </form>

                    <div class="loading" id="loadingState">
                        <div class="spinner"></div>
                        <p>Submitting your assignment...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Membership Tab -->
        <div class="tab-content" id="membership-tab">
            <div class="membership-section">
                <!-- Tier Indicators -->
                <div class="tier-indicators">
                    <div class="tier-pill basic">
                        <span class="tier-dot"></span>
                        <span>Basic 5%</span>
                    </div>
                    <div class="tier-pill silver">
                        <span class="tier-dot"></span>
                        <span>Silver 10%</span>
                    </div>
                    <div class="tier-pill gold">
                        <span class="tier-dot"></span>
                        <span>Gold 15%</span>
                    </div>
                    <div class="tier-pill platinum">
                        <span class="tier-dot"></span>
                        <span>Platinum 20%</span>
                    </div>
                </div>

                <!-- Auth Section (shown when not logged in) -->
                <div id="memberAuthSection">
                    <div class="membership-auth-container">
                        <!-- Benefits Side -->
                        <div class="membership-benefits-side">
                            <h2>Join HomeworkPal Membership</h2>
                            <p class="subtitle">Unlock exclusive discounts and perks on every order</p>
                            
                            <div class="benefit-list">
                                <div class="benefit-row">
                                    <div class="icon"><i class="fas fa-percentage"></i></div>
                                    <div class="content">
                                        <h4>Up to 20% Discount</h4>
                                        <p>Save more as you order more. Climb the tiers and unlock bigger discounts.</p>
                                    </div>
                                </div>
                                <div class="benefit-row">
                                    <div class="icon"><i class="fas fa-bolt"></i></div>
                                    <div class="content">
                                        <h4>Priority Processing</h4>
                                        <p>Your assignments get priority attention from our top writers.</p>
                                    </div>
                                </div>
                                <div class="benefit-row">
                                    <div class="icon"><i class="fas fa-gift"></i></div>
                                    <div class="content">
                                        <h4>Earn Referral Rewards</h4>
                                        <p>Get your unique referral link and earn when friends sign up.</p>
                                    </div>
                                </div>
                                <div class="benefit-row">
                                    <div class="icon"><i class="fas fa-headset"></i></div>
                                    <div class="content">
                                        <h4>24/7 VIP Support</h4>
                                        <p>Dedicated support for all your questions and concerns.</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Auth Forms Side -->
                        <div class="membership-auth-side">
                            <div class="auth-mode-toggle">
                                <button class="auth-mode-btn" data-mode="register">Create Account</button>
                                <button class="auth-mode-btn active" data-mode="login">Sign In</button>
                            </div>

                            <!-- Register Form -->
                            <form id="memberRegisterForm" class="seamless-form">
                                <div class="input-row">
                                    <div class="seamless-input-group">
                                        <label>Full Name</label>
                                        <input type="text" class="seamless-input" id="memberRegName" required placeholder="John Doe">
                                    </div>
                                    <div class="seamless-input-group">
                                        <label>Email Address</label>
                                        <input type="email" class="seamless-input" id="memberRegEmail" required placeholder="john@example.com">
                                    </div>
                                </div>
                                <div class="input-row">
                                    <div class="seamless-input-group">
                                        <label>Phone (optional)</label>
                                        <input type="tel" class="seamless-input" id="memberRegPhone" placeholder="+1 234 567 8900">
                                    </div>
                                    <div class="seamless-input-group">
                                        <label>Password</label>
                                        <input type="password" class="seamless-input" id="memberRegPassword" required placeholder="Min 6 characters" minlength="6">
                                    </div>
                                </div>
                                <button type="submit" class="auth-submit-btn">
                                    <i class="fas fa-user-plus"></i> Create Account
                                </button>
                            </form>

                            <!-- Login Form -->
                            <form id="memberLoginForm" class="seamless-form active">
                                <div class="seamless-input-group">
                                    <label>Email Address</label>
                                    <input type="email" class="seamless-input" id="memberLoginEmail" required placeholder="john@example.com">
                                </div>
                                <div class="seamless-input-group">
                                    <label>Password</label>
                                    <input type="password" class="seamless-input" id="memberLoginPassword" required placeholder="Your password">
                                </div>
                                <button type="submit" class="auth-submit-btn">
                                    <i class="fas fa-sign-in-alt"></i> Sign In to Dashboard
                                </button>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Member Portal (shown when logged in) -->
                <div id="memberPortal" class="member-portal">
                    <!-- Portal Header -->
                    <div class="portal-header">
                        <div class="portal-user">
                            <div class="portal-avatar" id="portalAvatar">JD</div>
                            <div class="portal-user-info">
                                <h3 id="portalName">John Doe</h3>
                                <span class="tier-badge basic" id="portalTierBadge">
                                    <i class="fas fa-medal"></i> Basic Member
                                </span>
                            </div>
                        </div>
                        <button class="portal-logout-btn" onclick="logoutMember()">
                            <i class="fas fa-sign-out-alt"></i> Sign Out
                        </button>
                    </div>

                    <!-- Stats Grid -->
                    <div class="portal-stats">
                        <div class="stat-card">
                            <div class="stat-value" id="portalDiscount">5%</div>
                            <div class="stat-label">Your Discount</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="portalOrders">0</div>
                            <div class="stat-label">Total Orders</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="portalSpent">$0</div>
                            <div class="stat-label">Total Spent</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="portalOrdersToNext">5</div>
                            <div class="stat-label">Orders to Next Tier</div>
                        </div>
                    </div>

                    <!-- Portal Grid -->
                    <div class="portal-grid">
                        <!-- Left Column -->
                        <div>
                            <!-- Progress Section -->
                            <div class="progress-section">
                                <h4><i class="fas fa-chart-line"></i> Tier Progress</h4>
                                
                                <div class="tier-progress">
                                    <div class="progress-header">
                                        <span class="current" id="currentTierLabel">Basic Member</span>
                                        <span class="next" id="nextTierLabel">Next: Silver</span>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="tierProgressBar" style="width: 0%"></div>
                                    </div>
                                    <div class="progress-details">
                                        <span id="ordersProgress">0/5 orders</span>
                                        <span id="spentProgress">$0/$100 spent</span>
                                    </div>
                                </div>

                                <!-- Quick Actions -->
                                <div class="quick-actions-grid">
                                    <button class="quick-action-btn" onclick="showTab('submit')">
                                        <i class="fas fa-paper-plane"></i>
                                        <span>New Order</span>
                                    </button>
                                    <button class="quick-action-btn" onclick="showTab('pricing')">
                                        <i class="fas fa-tags"></i>
                                        <span>View Pricing</span>
                                    </button>
                                </div>
                            </div>

                            <!-- Perks -->
                            <div class="portal-perks">
                                <h5><i class="fas fa-gift" style="margin-right: 0.5rem; color: #10b981;"></i>Your Perks</h5>
                                <div id="portalPerksList">
                                    <div class="perk-item"><i class="fas fa-check-circle"></i> Early access to new services</div>
                                    <div class="perk-item"><i class="fas fa-check-circle"></i> Priority email support</div>
                                </div>
                            </div>
                        </div>

                        <!-- Right Column - Referral -->
                        <div class="referral-section">
                            <h4><i class="fas fa-users"></i> Your Referral Link</h4>
                            <p>Share your link and earn rewards when friends join!</p>
                            
                            <div class="referral-code-box">
                                <input type="text" class="referral-code-input" id="memberReferralLink" readonly value="Loading...">
                                <button class="referral-copy-btn" onclick="copyMemberReferralLink()">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </div>

                            <div class="referral-share-buttons">
                                <button class="share-btn whatsapp" onclick="shareMemberWhatsApp()">
                                    <i class="fab fa-whatsapp"></i> WhatsApp
                                </button>
                                <button class="share-btn copy-link" onclick="copyMemberReferralLink()">
                                    <i class="fas fa-link"></i> Copy Link
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Inquiry Tab -->
        <div class="tab-content" id="inquiry-tab">
            <div class="form-container">
                <div class="form-card">
                    <div style="text-align: center; margin-bottom: 2rem;">
                        <div style="width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(135deg, #6366f1, #8b5cf6); display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; font-size: 1.5rem;">
                            <i class="fas fa-question-circle"></i>
                        </div>
                        <h2>Have a Question?</h2>
                        <p style="color: rgba(255,255,255,0.5); margin-top: 0.5rem;">Send us your inquiry and we'll get back to you shortly</p>
                    </div>

                    <form id="inquiryForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Your Name <span class="required">*</span></label>
                                <input type="text" id="inquiryName" required placeholder="John Doe">
                            </div>
                            <div class="form-group">
                                <label>Email Address <span class="required">*</span></label>
                                <input type="email" id="inquiryEmail" required placeholder="john@example.com">
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Subject <span class="required">*</span></label>
                            <select id="inquirySubject" required>
                                <option value="">Select a subject</option>
                                <option value="pricing">Pricing Question</option>
                                <option value="custom">Custom Order</option>
                                <option value="revision">Revision Request</option>
                                <option value="deadline">Deadline Extension</option>
                                <option value="refund">Refund Request</option>
                                <option value="other">Other</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Your Message <span class="required">*</span></label>
                            <textarea id="inquiryMessage" required rows="6" placeholder="Type your message here..."></textarea>
                        </div>

                        <div class="form-submit">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-paper-plane"></i> Send Inquiry
                            </button>
                        </div>
                    </form>

                    <div class="loading hidden" id="inquiryLoading">
                        <div class="spinner"></div>
                        <p>Sending your inquiry...</p>
                    </div>

                    <div class="success-container hidden" id="inquirySuccess" style="text-align: center;">
                        <div class="success-icon" style="background: linear-gradient(135deg, #10b981, #059669); width: 50px; height: 50px; margin: 0 auto 1rem;">
                            <i class="fas fa-check" style="font-size: 1.5rem;"></i>
                        </div>
                        <h3>Inquiry Sent!</h3>
                        <p style="color: rgba(255,255,255,0.5); margin-top: 0.5rem;">We'll respond to your email within 24 hours.</p>
                        <button class="btn btn-ghost" style="margin-top: 1.5rem; border: 1px solid rgba(255,255,255,0.1);" onclick="resetInquiryForm()">
                            <i class="fas fa-plus"></i> Send Another Inquiry
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Success State -->
        <div class="tab-content" id="success-tab">
            <div class="success-container">
                <div class="success-icon">
                    <i class="fas fa-check"></i>
                </div>
                <h2>Assignment Submitted!</h2>
                <p>We've received your assignment and will get started right away. You'll receive updates via email.</p>
                <div class="order-id" id="orderId">HP-000000</div>
                <p style="font-size: 0.85rem;">Please save this order ID for reference</p>
                <div style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                    <a href="/client" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Submit Another
                    </a>
                    <a href="/" class="btn btn-ghost" style="border: 1px solid rgba(255,255,255,0.1);">
                        <i class="fas fa-home"></i> Back to Home
                    </a>
                </div>

                <!-- Referral Share Box -->
                <div class="referral-success-box" id="referralBox">
                    <h4><i class="fas fa-gift"></i> Share & Earn Rewards!</h4>
                    <p style="color: rgba(255,255,255,0.6); font-size: 0.9rem;">Invite friends and earn <strong>10% credit</strong> when they complete their first order!</p>
                    <div class="referral-code-display">
                        <input type="text" id="referralLinkDisplay" readonly value="Loading...">
                        <button class="copy-btn" onclick="copyReferralLink()">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                    <div class="referral-share-btns">
                        <button class="share-whatsapp" onclick="shareWhatsApp()">
                            <i class="fab fa-whatsapp"></i> Share on WhatsApp
                        </button>
                        <button class="share-copy" onclick="copyReferralLink()">
                            <i class="fas fa-link"></i> Copy Link
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div class="toast-container" id="toastContainer"></div>

    <script>
        let selectedPackageData = { name: 'silver', minPrice: 9.99, maxPrice: 14.99 };
        let selectedDomain = '';
        let selectedDeadlineHours = 72;
        let uploadedFiles = [];
        let referralCode = null;
        let clientReferralLink = '';

        // Check for referral code in URL on page load
        document.addEventListener('DOMContentLoaded', async () => {
            const urlParams = new URLSearchParams(window.location.search);
            const ref = urlParams.get('ref');
            
            if (ref) {
                try {
                    const response = await fetch(`/api/referrals/validate/${ref}`);
                    const data = await response.json();
                    
                    if (data.valid) {
                        referralCode = ref.toUpperCase();
                        document.getElementById('referrerName').textContent = data.referrerName;
                        document.getElementById('referralBanner').classList.remove('hidden');
                    }
                } catch (error) {
                    console.error('Error validating referral code:', error);
                }
            }
        });

        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => showTab(tab.dataset.tab));
        });

        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            document.querySelector(`[data-tab="${tabName}"]`)?.classList.add('active');
            document.getElementById(`${tabName}-tab`)?.classList.add('active');
        }

        // Package selection
        function selectPackage(name, minPrice, maxPrice) {
            selectedPackageData = { name, minPrice, maxPrice };
            
            const icons = {
                bronze: { bg: 'linear-gradient(135deg, #cd7f32, #8b4513)', icon: 'fa-medal' },
                silver: { bg: 'linear-gradient(135deg, #c0c0c0, #808080)', icon: 'fa-medal' },
                gold: { bg: 'linear-gradient(135deg, #ffd700, #b8860b)', icon: 'fa-crown' }
            };

            const iconEl = document.getElementById('packageIcon');
            iconEl.style.background = icons[name].bg;
            iconEl.innerHTML = `<i class="fas ${icons[name].icon}"></i>`;
            
            document.getElementById('packageName').textContent = `${name.charAt(0).toUpperCase() + name.slice(1)} Package`;
            document.getElementById('packagePrice').textContent = `$${minPrice} - $${maxPrice} per page`;
            
            calculatePrice();
            showTab('submit');
        }

        // Domain selection
        document.querySelectorAll('.domain-option').forEach(option => {
            option.addEventListener('click', () => {
                document.querySelectorAll('.domain-option').forEach(o => o.classList.remove('selected'));
                option.classList.add('selected');
                selectedDomain = option.dataset.domain;
            });
        });

        // Deadline selection
        document.querySelectorAll('.deadline-option').forEach(option => {
            option.addEventListener('click', () => {
                document.querySelectorAll('.deadline-option').forEach(o => o.classList.remove('selected'));
                option.classList.add('selected');
                selectedDeadlineHours = parseInt(option.dataset.hours);
            });
        });

        // Pages input
        document.getElementById('pages').addEventListener('input', function() {
            const pages = parseInt(this.value) || 1;
            document.getElementById('wordCount').value = `~${pages * 275} words`;
            calculatePrice();
        });

        function calculatePrice() {
            const pages = parseInt(document.getElementById('pages').value) || 1;
            const min = pages * selectedPackageData.minPrice;
            const max = pages * selectedPackageData.maxPrice;
            document.getElementById('priceEstimate').textContent = `$${min} - $${max}`;
        }

        // File upload
        const fileUpload = document.getElementById('fileUpload');
        const fileInput = document.getElementById('fileInput');

        fileUpload.addEventListener('click', () => fileInput.click());
        fileUpload.addEventListener('dragover', e => {
            e.preventDefault();
            fileUpload.style.borderColor = '#6366f1';
        });
        fileUpload.addEventListener('dragleave', () => {
            fileUpload.style.borderColor = 'rgba(255,255,255,0.1)';
        });
        fileUpload.addEventListener('drop', e => {
            e.preventDefault();
            fileUpload.style.borderColor = 'rgba(255,255,255,0.1)';
            handleFiles(e.dataTransfer.files);
        });
        fileInput.addEventListener('change', () => handleFiles(fileInput.files));

        function handleFiles(files) {
            for (const file of files) {
                if (file.size > 10 * 1024 * 1024) {
                    showToast('error', `${file.name} is too large (max 10MB)`);
                    continue;
                }
                uploadedFiles.push(file);
            }
            renderUploadedFiles();
        }

        function renderUploadedFiles() {
            const container = document.getElementById('uploadedFiles');
            container.innerHTML = uploadedFiles.map((file, i) => `
                <div class="uploaded-file">
                    <i class="fas fa-file"></i>
                    <span>${file.name}</span>
                    <span class="remove" onclick="removeFile(${i})"><i class="fas fa-times"></i></span>
                </div>
            `).join('');
        }

        function removeFile(index) {
            uploadedFiles.splice(index, 1);
            renderUploadedFiles();
        }

        // Form submission
        document.getElementById('assignmentForm').addEventListener('submit', async e => {
            e.preventDefault();
            
            if (!selectedDomain) {
                showToast('error', 'Please select a domain');
                return;
            }

            const title = document.getElementById('title').value.trim();
            const description = document.getElementById('description').value.trim();
            const clientName = document.getElementById('clientName').value.trim();
            const clientEmail = document.getElementById('clientEmail').value.trim();
            const pages = document.getElementById('pages').value;

            if (!title || !description || !clientName || !clientEmail) {
                showToast('error', 'Please fill all required fields');
                return;
            }

            // Show loading
            document.querySelector('.form-card form').style.display = 'none';
            document.querySelector('.selected-package').style.display = 'none';
            document.getElementById('loadingState').classList.add('active');

            const deadline = new Date(Date.now() + selectedDeadlineHours * 60 * 60 * 1000);
            const wordCount = `${pages * 250}-${pages * 300}`;

            const formData = new FormData();
            formData.append('title', title);
            formData.append('domain', selectedDomain);
            formData.append('description', `[${selectedPackageData.name.toUpperCase()} PACKAGE]\n\n${description}`);
            formData.append('word_count_min', pages * 250);
            formData.append('word_count_max', pages * 300);
            formData.append('deadline', deadline.toISOString());
            formData.append('links', '');
            formData.append('client_name', clientName);
            formData.append('client_email', clientEmail);
            formData.append('client_phone', document.getElementById('clientPhone').value);
            
            // Include referral code if present
            if (referralCode) {
                formData.append('referral_code', referralCode);
            }

            uploadedFiles.forEach(file => formData.append('files', file));

            try {
                const response = await fetch('/api/client/submit', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();
                document.getElementById('loadingState').classList.remove('active');

                if (response.ok) {
                    document.getElementById('orderId').textContent = `HP-${result.assignment_id.toString().padStart(6, '0')}`;
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    document.getElementById('success-tab').classList.add('active');
                    
                    // Get or create referral code for this client
                    fetchReferralCode(clientName, clientEmail);
                } else {
                    document.querySelector('.form-card form').style.display = 'block';
                    document.querySelector('.selected-package').style.display = 'flex';
                    showToast('error', result.error || 'Failed to submit');
                }
            } catch (error) {
                document.getElementById('loadingState').classList.remove('active');
                document.querySelector('.form-card form').style.display = 'block';
                document.querySelector('.selected-package').style.display = 'flex';
                showToast('error', 'Network error. Please try again.');
            }
        });

        function showToast(type, message) {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `<i class="fas fa-${type === 'error' ? 'exclamation-circle' : 'check-circle'}"></i> ${message}`;
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 4000);
        }

        // Inquiry form handler
        document.getElementById('inquiryForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const name = document.getElementById('inquiryName').value.trim();
            const email = document.getElementById('inquiryEmail').value.trim();
            const subject = document.getElementById('inquirySubject').value;
            const message = document.getElementById('inquiryMessage').value.trim();

            if (!name || !email || !subject || !message) {
                showToast('error', 'Please fill all required fields');
                return;
            }

            // Show loading
            document.getElementById('inquiryForm').classList.add('hidden');
            document.getElementById('inquiryLoading').classList.remove('hidden');

            try {
                const response = await fetch('/api/client/inquiry', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, email, subject, message })
                });

                const result = await response.json();
                document.getElementById('inquiryLoading').classList.add('hidden');

                if (response.ok) {
                    document.getElementById('inquirySuccess').classList.remove('hidden');
                } else {
                    document.getElementById('inquiryForm').classList.remove('hidden');
                    showToast('error', result.error || 'Failed to send inquiry');
                }
            } catch (error) {
                document.getElementById('inquiryLoading').classList.add('hidden');
                document.getElementById('inquiryForm').classList.remove('hidden');
                showToast('error', 'Network error. Please try again.');
            }
        });

        function resetInquiryForm() {
            document.getElementById('inquiryForm').reset();
            document.getElementById('inquiryForm').classList.remove('hidden');
            document.getElementById('inquirySuccess').classList.add('hidden');
        }

        // Referral Functions
        async function fetchReferralCode(name, email) {
            try {
                const response = await fetch('/api/referrals/code', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, email })
                });
                
                const data = await response.json();
                
                if (data.referralLink) {
                    clientReferralLink = data.referralLink;
                    document.getElementById('referralLinkDisplay').value = clientReferralLink;
                    document.getElementById('referralBox').style.display = 'block';
                }
            } catch (error) {
                console.error('Error fetching referral code:', error);
                document.getElementById('referralBox').style.display = 'none';
            }
        }

        function copyReferralLink() {
            const input = document.getElementById('referralLinkDisplay');
            input.select();
            input.setSelectionRange(0, 99999);
            
            navigator.clipboard.writeText(clientReferralLink).then(() => {
                showToast('success', 'Referral link copied to clipboard!');
            }).catch(() => {
                document.execCommand('copy');
                showToast('success', 'Referral link copied!');
            });
        }

        function shareWhatsApp() {
            const message = encodeURIComponent(`Hey! I just used HomeworkPal for my assignment and it was great! ðŸŽ“\n\nUse my referral link to get 10% off your first order:\n${clientReferralLink}`);
            window.open(`https://wa.me/?text=${message}`, '_blank');
        }

        // ========== MEMBERSHIP FUNCTIONS ==========
        
        let memberReferralLink = '';
        
        // Check membership status on page load
        const memberToken = localStorage.getItem('memberToken');
        if (memberToken) {
            loadMemberProfile();
        }

        // Auth mode toggle (new seamless design)
        document.querySelectorAll('.auth-mode-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.auth-mode-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                const mode = btn.dataset.mode;
                document.querySelectorAll('.seamless-form').forEach(form => form.classList.remove('active'));
                document.getElementById(mode === 'login' ? 'memberLoginForm' : 'memberRegisterForm').classList.add('active');
            });
        });

        // Member Registration - Auto switch to login after success
        document.getElementById('memberRegisterForm')?.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const name = document.getElementById('memberRegName').value;
            const email = document.getElementById('memberRegEmail').value;
            const phone = document.getElementById('memberRegPhone').value;
            const password = document.getElementById('memberRegPassword').value;
            
            const submitBtn = e.target.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating Account...';
            
            try {
                const response = await fetch('/api/membership/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, email, phone, password })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    if (data.needsVerification) {
                        // Email verification required
                        showToast('success', data.message, 8000);
                        
                        // Reset form
                        document.getElementById('memberRegisterForm').reset();
                        
                        // Show verification notice
                        showVerificationNotice(email);
                    } else {
                        // Auto-verified (fallback if email fails)
                        showToast('success', `Account created! Please sign in.`);
                        
                        // Reset form
                        document.getElementById('memberRegisterForm').reset();
                        
                        // Auto switch to login tab
                        document.querySelectorAll('.auth-mode-btn').forEach(b => b.classList.remove('active'));
                        document.querySelector('.auth-mode-btn[data-mode="login"]').classList.add('active');
                        document.querySelectorAll('.seamless-form').forEach(form => form.classList.remove('active'));
                        document.getElementById('memberLoginForm').classList.add('active');
                        
                        // Pre-fill email in login form
                        document.getElementById('memberLoginEmail').value = email;
                        document.getElementById('memberLoginPassword').focus();
                    }
                } else {
                    if (data.needsVerification) {
                        showToast('info', data.error, 6000);
                    } else {
                        showToast('error', data.error || 'Registration failed');
                    }
                }
            } catch (error) {
                console.error('Registration error:', error);
                showToast('error', 'Failed to register. Please try again.');
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fas fa-user-plus"></i> Create Account';
            }
        });
        
        // Show verification notice in auth area
        function showVerificationNotice(email) {
            const authSide = document.querySelector('.membership-auth-side');
            const existingNotice = document.getElementById('verificationNotice');
            if (existingNotice) existingNotice.remove();
            
            const notice = document.createElement('div');
            notice.id = 'verificationNotice';
            notice.innerHTML = `
                <div style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(6, 182, 212, 0.1)); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 12px; padding: 20px; margin-bottom: 20px; text-align: center;">
                    <div style="font-size: 40px; margin-bottom: 10px;">ðŸ“§</div>
                    <h3 style="color: #10b981; margin-bottom: 10px;">Check Your Email!</h3>
                    <p style="color: rgba(255,255,255,0.8); margin-bottom: 15px;">
                        We've sent a verification link to <strong>${email}</strong>
                    </p>
                    <p style="color: rgba(255,255,255,0.6); font-size: 14px; margin-bottom: 15px;">
                        Click the link in your email to verify your account and start enjoying member benefits.
                    </p>
                    <button onclick="resendVerification('${email}')" style="background: rgba(99, 102, 241, 0.2); color: #818cf8; border: 1px solid rgba(99, 102, 241, 0.3); padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 14px;">
                        <i class="fas fa-redo"></i> Resend Email
                    </button>
                    <button onclick="document.getElementById('verificationNotice').remove()" style="background: transparent; color: rgba(255,255,255,0.5); border: none; padding: 8px 16px; cursor: pointer; font-size: 14px; margin-left: 10px;">
                        Dismiss
                    </button>
                </div>
            `;
            authSide.insertBefore(notice, authSide.firstChild);
        }
        
        // Resend verification email
        async function resendVerification(email) {
            try {
                const response = await fetch('/api/membership/resend-verification', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    showToast('success', 'Verification email sent! Check your inbox.');
                } else {
                    showToast('error', data.error || 'Failed to resend email');
                }
            } catch (error) {
                console.error('Resend error:', error);
                showToast('error', 'Failed to resend verification email');
            }
        }

        // Member Login
        document.getElementById('memberLoginForm')?.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const email = document.getElementById('memberLoginEmail').value;
            const password = document.getElementById('memberLoginPassword').value;
            
            const submitBtn = e.target.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Signing In...';
            
            try {
                const response = await fetch('/api/membership/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    localStorage.setItem('memberToken', data.token);
                    localStorage.setItem('memberEmail', data.member.email);
                    localStorage.setItem('memberName', data.member.name);
                    showToast('success', `Welcome back, ${data.member.name}!`);
                    await loadMemberProfile();
                    
                    // Ensure membership tab is active and scroll to portal
                    setTimeout(() => {
                        showTab('membership');
                        document.getElementById('memberPortal').scrollIntoView({ 
                            behavior: 'smooth', 
                            block: 'start' 
                        });
                    }, 100);
                } else {
                    if (data.needsVerification) {
                        showToast('warning', data.error, 6000);
                        showVerificationNotice(email);
                    } else {
                        showToast('error', data.error || 'Login failed');
                    }
                }
            } catch (error) {
                console.error('Login error:', error);
                showToast('error', 'Failed to login. Please try again.');
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fas fa-sign-in-alt"></i> Sign In to Dashboard';
            }
        });

        // Load Member Profile - Updated for new portal design
        async function loadMemberProfile() {
            const token = localStorage.getItem('memberToken');
            if (!token) return;
            
            try {
                const response = await fetch('/api/membership/profile', {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                
                if (!response.ok) {
                    if (response.status === 401) {
                        logoutMember();
                    }
                    return;
                }
                
                const data = await response.json();
                const member = data.member;
                
                // Store member data
                localStorage.setItem('memberDiscount', member.discount_percent);
                
                // Update portal header
                const initials = member.name.split(' ').map(n => n[0]).join('').toUpperCase();
                document.getElementById('portalAvatar').textContent = initials;
                document.getElementById('portalName').textContent = member.name;
                
                const tierBadge = document.getElementById('portalTierBadge');
                tierBadge.textContent = `${capitalizeFirst(member.membership_tier)} Member`;
                tierBadge.className = `tier-badge ${member.membership_tier}`;
                
                // Update stats
                document.getElementById('portalDiscount').textContent = `${member.discount_percent}%`;
                document.getElementById('portalOrders').textContent = member.total_orders || 0;
                document.getElementById('portalSpent').textContent = `$${parseFloat(member.total_spent || 0).toFixed(0)}`;
                
                // Calculate orders to next tier
                const ordersToNext = calculateOrdersToNextTier(member);
                document.getElementById('portalOrdersToNext').textContent = ordersToNext;
                
                // Update tier progress
                updateTierProgress(member);
                
                // Update perks
                updatePortalPerks(member.membership_tier);
                
                // Load member referral link
                loadMemberReferralLink(member.name, member.email);
                
                // Show portal, hide auth
                document.getElementById('memberAuthSection').style.display = 'none';
                document.getElementById('memberPortal').classList.add('active');
                
            } catch (error) {
                console.error('Error loading profile:', error);
            }
        }

        function calculateOrdersToNextTier(member) {
            const tiers = ['basic', 'silver', 'gold', 'platinum'];
            const requirements = {
                silver: { orders: 5 },
                gold: { orders: 15 },
                platinum: { orders: 30 }
            };
            
            const currentIndex = tiers.indexOf(member.membership_tier);
            if (currentIndex >= tiers.length - 1) return 'ðŸŽ‰';
            
            const nextTier = tiers[currentIndex + 1];
            const ordersNeeded = Math.max(0, requirements[nextTier].orders - (member.total_orders || 0));
            return ordersNeeded;
        }

        function updateTierProgress(member) {
            const tiers = ['basic', 'silver', 'gold', 'platinum'];
            const requirements = {
                silver: { orders: 5, spent: 100 },
                gold: { orders: 15, spent: 500 },
                platinum: { orders: 30, spent: 1500 }
            };
            
            const currentIndex = tiers.indexOf(member.membership_tier);
            const currentOrders = member.total_orders || 0;
            const currentSpent = parseFloat(member.total_spent || 0);
            
            // Update labels
            document.getElementById('currentTierLabel').textContent = `${capitalizeFirst(member.membership_tier)} Member`;
            
            if (currentIndex >= tiers.length - 1) {
                document.getElementById('nextTierLabel').textContent = 'Max Tier!';
                document.getElementById('tierProgressBar').style.width = '100%';
                document.getElementById('ordersProgress').textContent = `${currentOrders} orders`;
                document.getElementById('spentProgress').textContent = `$${currentSpent.toFixed(0)} spent`;
                return;
            }
            
            const nextTier = tiers[currentIndex + 1];
            const req = requirements[nextTier];
            
            document.getElementById('nextTierLabel').textContent = `Next: ${capitalizeFirst(nextTier)}`;
            
            // Calculate progress percentage
            const orderProgress = (currentOrders / req.orders) * 100;
            const spentProgress = (currentSpent / req.spent) * 100;
            const progress = Math.max(orderProgress, spentProgress);
            
            document.getElementById('tierProgressBar').style.width = `${Math.min(progress, 100)}%`;
            document.getElementById('ordersProgress').textContent = `${currentOrders}/${req.orders} orders`;
            document.getElementById('spentProgress').textContent = `$${currentSpent.toFixed(0)}/$${req.spent}`;
        }

        function updatePortalPerks(tier) {
            const perks = {
                basic: [
                    '5% discount on all orders',
                    'Priority email support',
                    'Referral program access'
                ],
                silver: [
                    '10% discount on all orders',
                    'Priority email support',
                    'Free revision requests',
                    'Referral program access'
                ],
                gold: [
                    '15% discount on all orders',
                    'Priority support (24/7)',
                    'Free revisions',
                    'Dedicated writer option',
                    'Referral program access'
                ],
                platinum: [
                    '20% discount on all orders',
                    'VIP support (24/7)',
                    'Unlimited revisions',
                    'Dedicated account manager',
                    'Early access to promotions',
                    'Referral program access'
                ]
            };
            
            const perksList = document.getElementById('portalPerksList');
            perksList.innerHTML = (perks[tier] || perks.basic).map(perk => 
                `<div class="perk-item"><i class="fas fa-check-circle"></i> ${perk}</div>`
            ).join('');
        }

        async function loadMemberReferralLink(name, email) {
            try {
                const response = await fetch('/api/referrals/code', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, email })
                });
                
                const data = await response.json();
                
                if (data.referralLink) {
                    memberReferralLink = data.referralLink;
                    document.getElementById('memberReferralLink').value = memberReferralLink;
                }
            } catch (error) {
                console.error('Error fetching member referral link:', error);
            }
        }

        function copyMemberReferralLink() {
            const input = document.getElementById('memberReferralLink');
            input.select();
            input.setSelectionRange(0, 99999);
            
            navigator.clipboard.writeText(memberReferralLink).then(() => {
                showToast('success', 'Referral link copied!');
            }).catch(() => {
                document.execCommand('copy');
                showToast('success', 'Referral link copied!');
            });
        }

        function shareMemberWhatsApp() {
            const message = encodeURIComponent(`Hey! Join HomeworkPal and get 10% off your first order! ðŸŽ“\n\n${memberReferralLink}`);
            window.open(`https://wa.me/?text=${message}`, '_blank');
        }

        function logoutMember() {
            localStorage.removeItem('memberToken');
            localStorage.removeItem('memberEmail');
            localStorage.removeItem('memberName');
            localStorage.removeItem('memberDiscount');
            
            // Reset forms
            document.getElementById('memberRegisterForm')?.reset();
            document.getElementById('memberLoginForm')?.reset();
            
            // Show auth, hide portal
            document.getElementById('memberAuthSection').style.display = 'block';
            document.getElementById('memberPortal').classList.remove('active');
            
            showToast('success', 'You have been signed out.');
        }

        function capitalizeFirst(str) {
            return str.charAt(0).toUpperCase() + str.slice(1);
        }

        // Price calculation based on complexity
        function calculatePriceWithComplexity(pages, packageData, complexity = 'medium') {
            const complexityMultipliers = {
                simple: 0,      // Use lower bracket
                medium: 0.5,    // Use average
                complex: 1      // Use upper bracket
            };
            
            const multiplier = complexityMultipliers[complexity] || 0.5;
            const priceRange = packageData.maxPrice - packageData.minPrice;
            const basePrice = packageData.minPrice + (priceRange * multiplier);
            
            return (pages * basePrice).toFixed(2);
        }

        // Apply member discount to calculations
        function getMemberDiscountedPrice(originalPrice) {
            const memberDiscount = parseInt(localStorage.getItem('memberDiscount') || '0');
            if (memberDiscount > 0) {
                const discount = originalPrice * (memberDiscount / 100);
                return {
                    original: originalPrice,
                    discount: discount.toFixed(2),
                    final: (originalPrice - discount).toFixed(2),
                    percent: memberDiscount
                };
            }
            return { original: originalPrice, discount: 0, final: originalPrice, percent: 0 };
        }

        // Initialize
        calculatePrice();
    </script>
</body>
</html>
